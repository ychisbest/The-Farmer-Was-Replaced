---
// Import the global.css file here so that it is included on
// all pages through the use of the <BaseHead /> component.
import { SITE_TITLE } from "../consts";
import FallbackImage from "../assets/og.png";
import type { ImageMetadata } from "astro";
import { useTranslations, type Lang } from "@/i18n";

interface Props {
	title: string;
	description: string;
	image?: ImageMetadata;
}

const canonicalURL = new URL(Astro.url.pathname, Astro.site);

const { title, description, image = FallbackImage } = Astro.props;

const t = useTranslations(Astro.currentLocale as Lang);

// Additional SEO keywords for educational programming games
const keywords = {
	en: "programming game, learn Python, educational game, coding game, farm automation, Python tutorial, learn coding, educational technology, STEM education, coding for beginners",
	zh: "编程游戏,学习Python,教育游戏,编程游戏,农场自动化,Python教程,学习编程,教育技术,STEM教育,编程入门",
};

// Additional meta tags for enhanced SEO
const currentLocale = Astro.currentLocale || "en";
---

<!-- Global Metadata -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<meta name="color-scheme" content="light dark" />

<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
<link rel="manifest" href="/site.webmanifest" />

<link rel="sitemap" href="/sitemap-index.xml" />
<link
	rel="alternate"
	type="application/rss+xml"
	title={t(SITE_TITLE)}
	href={new URL("rss.xml", Astro.site)}
/>
<meta name="generator" content={Astro.generator} />

<!-- Canonical URL -->
<link rel="canonical" href={canonicalURL} />

<!-- Hreflang Tags for International SEO -->
{
	currentLocale === "en" && (
		<link rel="alternate" hreflang="en" href={canonicalURL} />
	)
}
{
	currentLocale === "en" && (
		<link
			rel="alternate"
			hreflang="zh"
			href={
				new URL(
					Astro.url.pathname.replace(/^\//, "/zh/"),
					Astro.url.origin,
				)
			}
		/>
	)
}
{
	currentLocale === "zh" && (
		<link rel="alternate" hreflang="zh" href={canonicalURL} />
	)
}
{
	currentLocale === "zh" && (
		<link
			rel="alternate"
			hreflang="en"
			href={
				new URL(
					Astro.url.pathname.replace(/^\/zh\//, "/"),
					Astro.url.origin,
				)
			}
		/>
	)
}
<link
	rel="alternate"
	hreflang="x-default"
	href={new URL(Astro.url.pathname.replace(/^\/zh\//, "/"), Astro.url.origin)}
/>

<!-- Primary Meta Tags -->
<title>{title}</title>
<meta name="title" content={title} />
<meta name="description" content={description} />

<!-- Enhanced SEO Meta Tags -->
<meta
	name="keywords"
	content={keywords[currentLocale as keyof typeof keywords] || keywords.en}
/>
<meta name="author" content="The Farmer Was Replaced" />
<meta name="robots" content="index, follow, max-image-preview:large" />
<meta name="language" content={currentLocale} />
<meta name="revisit-after" content="7 days" />
<meta name="category" content="educational programming game" />
<meta name="coverage" content="Worldwide" />
<meta name="distribution" content="Global" />
<meta name="rating" content="General" />

<!-- Educational Content Specific Tags -->
<meta name="educational-role" content="student" />
<meta name="educational-use" content="programming instruction" />
<meta name="learning-resource-type" content="interactive game" />
<meta name="target-audience" content="beginning programmers" />
<meta name="subject" content="Python Programming" />

<!-- Additional SEO for Search Engines -->
<meta name="theme-color" content="#3b82f6" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="default" />
<meta name="apple-mobile-web-app-title" content="The Farmer Was Replaced" />

<!-- Additional Open Graph Properties -->
<meta property="og:site_name" content="The Farmer Was Replaced" />
<meta
	property="og:locale"
	content={currentLocale === "zh" ? "zh_CN" : "en_US"}
/>
<meta property="og:type" content="website" />
<meta property="og:updated_time" content={new Date().toISOString()} />

<!-- Enhanced Twitter Meta Tags -->
<meta name="twitter:creator" content="@thefarmerwasreplaced" />
<meta name="twitter:site" content="@thefarmerwasreplaced" />
<meta name="twitter:app:name:iphone" content="The Farmer Was Replaced" />
<meta name="twitter:app:name:ipad" content="The Farmer Was Replaced" />
<meta name="twitter:app:name:googleplay" content="The Farmer Was Replaced" />

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website" />
<meta property="og:url" content={Astro.url} />
<meta property="og:title" content={title} />
<meta property="og:description" content={description} />
<meta property="og:image" content={new URL(image.src, Astro.url)} />

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image" />
<meta property="twitter:url" content={Astro.url} />
<meta property="twitter:title" content={title} />
<meta property="twitter:description" content={description} />
<meta property="twitter:image" content={new URL(image.src, Astro.url)} />

<!-- Google Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
	href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans:wght@400;500;600;700&display=swap"
	rel="stylesheet"
/>

<script
	async
	src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8738419268805262"
	crossorigin="anonymous"></script>

<!-- Ahrefs Analytics -->
<script
	src="https://analytics.ahrefs.com/analytics.js"
	data-key="KvtyK+22jK0FbZWERPZrXw"
	async></script>

<script type="text/javascript">
	(function (c, l, a, r, i, t, y) {
		c[a] =
			c[a] ||
			function () {
				(c[a].q = c[a].q || []).push(arguments);
			};
		t = l.createElement(r);
		t.async = 1;
		t.src = "https://www.clarity.ms/tag/" + i;
		y = l.getElementsByTagName(r)[0];
		y.parentNode.insertBefore(t, y);
	})(window, document, "clarity", "script", "tt6tomsxh9");
</script>

<!-- Structured Data for SEO -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "{SITE_TITLE}",
  "description": "Learn Python programming through gamified farming automation. Complete code examples, tutorials, and educational resources for The Farmer Was Replaced game.",
  "url": "{Astro.site}",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "{Astro.site}search?q={search_term_string}",
    "query-input": "required name=search_term_string"
  },
  "publisher": {
    "@type": "Organization",
    "name": "The Farmer Was Replaced",
    "url": "{Astro.site}"
  },
  "educationalUse": "instructionalMaterial",
  "learningResourceType": "interactive game tutorial",
  "teaches": "Python programming",
  "inLanguage": ["en", "zh", "de"]
}
</script>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "EducationalOrganization",
  "name": "The Farmer Was Replaced",
  "description": "Educational programming game that teaches Python through farming automation",
  "url": "{Astro.site}",
  "sameAs": [
    "https://store.steampowered.com/app/2060160/_/"
  ],
  "educationalCredentialAwarded": "Python Programming Skills",
  "hasEducationalUse": "Programming Education",
  "teaches": [
    "Python Variables",
    "Control Structures",
    "Functions",
    "Algorithms",
    "Problem Solving"
  ]
}
</script>
